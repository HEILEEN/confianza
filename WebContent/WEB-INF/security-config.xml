<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:security="http://www.springframework.org/schema/security"
	xmlns:ldap="http://www.springframework.org/schema/ldap"
	xsi:schemaLocation="http://www.springframework.org/schema/ldap http://www.springframework.org/schema/ldap/spring-ldap.xsd
		http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

	<security:global-method-security jsr250-annotations="enabled"/>

	<security:http use-expressions="true" access-denied-page="/WEB-INF/denied.jsp" >
		<security:form-login login-page="/login.jsp" authentication-failure-url="/login.jsp?login_error=true" default-target-url="/index.jsp" authentication-success-handler-ref="myAuthenticationSuccessHandler"/>
		<security:intercept-url pattern="/index.jsp" access="isAuthenticated()"/>
		<security:intercept-url pattern="/menu.jsp"  access="isAuthenticated()"/>
		<security:intercept-url pattern="/confianza/**" access="isAuthenticated()"/>
		<security:logout invalidate-session="true" logout-url="/logout"/>
	</security:http>		
	
	<security:authentication-manager>
		<security:authentication-provider ref="authenticate" />								  
	</security:authentication-manager>
	
	<ldap:context-source
          url="ldap://192.168.100.2:389"
          base="dc=confianza,dc=local"
          username="webappconfianza"
          password="Confianza01" />
          
    <ldap:ldap-template id="ldapTemplate" ignore-partial-result="true" search-scope="SUBTREE" />
    
    <bean id="authenticate" class="com.confianza.webapp.service.security.AutenticateImpl"/>
    
    <bean id="passwordEncoder" class="org.springframework.security.authentication.encoding.Md5PasswordEncoder"/>    
    
    <bean id="myAuthenticationSuccessHandler" class="com.confianza.webapp.service.security.MySimpleUrlAuthenticationSuccessHandler" />
		
</beans>
